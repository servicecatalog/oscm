<!-- Copyright FUJITSU LIMITED 2020-->
<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:a4j="http://richfaces.org/a4j" xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:mp="http://www.fujitsu.com/global/services/software/interstage/marketplace"
                template="../templates/mainBootstrap.xhtml">

 <ui:define name="pageId">
  <c:set var="pageId" value="marketplace.account.subscriptions"/>
  <c:set var="dirty" value="false"/>
 </ui:define>

 <ui:define name="breadcrumbs">
  <mp:bootstrapBreadcrumbs>
   <mp:crumb labelPageId="marketplace.account" link="/marketplace/account/index.jsf"/>
   <mp:crumb labelPageId="#{pageId}"/>
  </mp:bootstrapBreadcrumbs>
 </ui:define>

 <ui:define name="aside">
  <mp:navigationMenu bean="#{accountNavigationBean}" selected="marketplace.account.subscriptions.title"/>
 </ui:define>

 <ui:define name="contents">
  <a4j:outputPanel layout="block" styleClass="container-fluid">

   <h:form id="triggerSubListForm"
           rendered="#{not empty subscriptionsCtrl.triggerProcessesModel.waitingForApprovalSubs}">
    <ui:include src="../subscriptions/triggerProcessesTable.xhtml">
     <ui:param name="data" value="#{subscriptionsCtrl.triggerProcessesModel.waitingForApprovalSubs}"/>
    </ui:include>
   </h:form>

   <mp:outputStep id="pageHeader" value="#{msg['subscriptions.table.availableToAdministrate']}"/>

   <h:form id="subListForm">
    <table id="table" class="table table-striped table-hover table-bordered" style="width:100%">
     <thead>
     <tr class="text-center">
      <th id="edit" class="all"></th>
      <th id="columnHeaderName" class="all">#{msg['subscriptions.table.name']}</th>
      <th id="columnHeaderReference" class="desktop">#{msg['subscriptions.table.reference']}</th>
      <th id="columnHeaderUnit" class="desktop">#{msg['subscriptions.unit']}</th>
      <th id="columnHeaderService" class="desktop">#{msg['subscription.service']}</th>
      <th id="columnHeaderActivation" class="min-tablet">#{msg['subscriptions.table.activation']}</th>
      <th id="columnHeaderStatus" class="all">#{msg['subscription.status']}</th>
     </tr>
     </thead>
     <tbody>
     <c:forEach items="#{mySubscriptionsCtrl.model.getSubscriptions()}" var="sub">
      <tr class="text-left">
       <td>
        <h:commandLink action="#{subscriptionsCtrl.showSubscriptionDetails(sub.subscriptionId, sub.subscriptionKey)}"
                       render=":hiddenErrorPanel subListForm">
         <i class="fa fa-pencil-square-o" aria-hidden="true"/>
         <f:setPropertyActionListener target="#{subscriptionsCtrl.model.selectedSubscription}" value="#{sub}"/>
        </h:commandLink>
       </td>
       <td>#{sub.subscriptionId}</td>
       <td>#{sub.purchaseOrderNumber}</td>
       <td>#{sub.unit}</td>
       <td>#{sub.serviceName}</td>
       <td>
        <h:outputText value="#{sub.activationDate}">
         <f:convertDateTime pattern="#{msg[appBean.dateInputPattern]}"
                            timeZone="#{appBean.timeZoneId}"/>
        </h:outputText>
       </td>
       <td>
        <ui:include src="status.xhtml">
         <ui:param name="subscription" value="#{sub}"/>
        </ui:include>
       </td>
      </tr>
     </c:forEach>
     <c:forEach items="#{mySubscriptionsCtrl.myTriggerProcessesModel.waitingForApprovalSubs}" var="sub">
      <tr class="text-left">
       <td>
        <h:commandLink action="#{subscriptionsCtrl.showSubscriptionDetails(sub.subscriptionId, sub.subscriptionKey)}"
                       render=":hiddenErrorPanel subListForm">
         <i class="fa fa-pencil-square-o" aria-hidden="true"/>
         <f:setPropertyActionListener target="#{subscriptionsCtrl.model.selectedSubscription}" value="#{sub}"/>
        </h:commandLink>
       </td>
       <td>#{sub.subscriptionId}</td>
       <td>#{sub.purchaseOrderNumber}</td>
       <td>#{sub.unit}</td>
       <td>#{sub.serviceName}</td>
       <td>
        <h:outputText value="#{sub.activationDate}">
         <f:convertDateTime pattern="#{msg[appBean.dateInputPattern]}"
                            timeZone="#{appBean.timeZoneId}"/>
        </h:outputText>
       </td>
       <td>
        <ui:include src="status.xhtml">
         <ui:param name="subscription" value="#{sub}"/>
        </ui:include>
       </td>
      </tr>
     </c:forEach>
     </tbody>
    </table>
   </h:form>

   <ui:include src="subscriptionAdministratePanel.xhtml">
    <ui:param name="dialogId" value="subscriptionAdministratePanel"/>
   </ui:include>
  </a4j:outputPanel>

  <mp:linkPageTop/>

  <style media="all" type="text/css">
 ul {
  width: 100% !important;
 }
 table.dataTable thead tr {
  background: rgba(0, 0, 0, 0.6);
  color: white;
 }
 table.dataTable tbody tr:hover{
  background: rgba(0, 0, 0, 0.5) !important;
  color: white;
 }
 table.dataTable tbody tr:nth-of-type(even){
  background: rgba(0, 0, 0, 0.2);
 }
 table.dataTable.dtr-inline.collapsed>tbody>tr>td.child {
  background: white;
  color: black;
 }
 a:visited {
 color: #F0FFFF !important;
 }
 table.dataTable.dtr-inline.collapsed>tbody>tr[role="row"]>td:first-child:before {
  background-color: darkslategray !important;
 }
}
  </style>

  <script type="text/javascript">
$(document).ready(function() {
 $('#table').DataTable({
  responsive: true,
  columnDefs: [{
   orderable: false,
   targets: 0
  }],
  renderer: $.fn.dataTable.Responsive.renderer.tableAll( {
   tableClass: 'table'
  })
 });
});
  </script>

  <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css"/>
  <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css"/>
 </ui:define>
</ui:composition>