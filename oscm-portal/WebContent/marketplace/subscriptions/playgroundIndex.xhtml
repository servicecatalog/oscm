<!-- Copyright FUJITSU LIMITED 2020-->
<!DOCTYPE html>
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:a4j="http://richfaces.org/a4j"
                xmlns:mp="http://www.fujitsu.com/global/services/software/interstage/marketplace"
                xmlns="http://www.w3.org/1999/xhtml" template="../templates/mainBootstrap.xhtml">
 <ui:define name="pageId">
  <c:set var="pageId" value="marketplace.subscriptions"/>
 </ui:define>

 <ui:define name="breadcrumbs">
  <mp:bootstrapBreadcrumbs>
   <mp:crumb labelPageId="#{pageId}"/>
  </mp:bootstrapBreadcrumbs>
 </ui:define>

 <ui:define name="contentstitle">
  <a4j:outputPanel layout="block" styleClass="contentstitle indent1col clearfix text-left">
   <h:outputText value="#{msg['marketplace.subscriptions.title']}"/>
  </a4j:outputPanel>
 </ui:define>

 <ui:define name="contents">
  <a4j:outputPanel layout="block" styleClass="container-fluid">

   <mp:outputStep id="pageHeader" value="#{msg['subscriptions.table.availableForUsage']}"/>
   <h:link fragment="anchor" styleClass="invisible-jumper"/>
   <h:form id="subListForm">
    <table id="table" class="table table-striped table-hover table-bordered" style="width:100%">
     <thead>
     <tr class="text-center">
      <th id="columnHeaderImage" class="all" style="width: 50px"/>
      <th id="columnHeaderName" class="all">#{msg['subscriptions.table.name']}</th>
      <th id="columnHeaderReference" class="desktop">#{msg['subscriptions.table.reference']}</th>
      <th id="columnHeaderService" class="desktop">#{msg['subscription.service']}</th>
      <th id="columnHeaderActivation" class="min-tablet">#{msg['subscriptions.table.activation']}</th>
      <th id="columnHeaderStatus" class="all">#{msg['subscription.status']}</th>
      <th id="details" class="none"/>
     </tr>
     </thead>
     <tbody>
     <c:forEach items="#{mySubscriptionsCtrl.model.getSubscriptions()}" var="sub">
      <tr>
       <td class="text-center"><img
         src="/oscm-portal/image?type=SERVICE_IMAGE&amp;serviceKey=#{sub.serviceKey}"
         alt="editSubImage#{sub.subscriptionId}" width="30"/></td>
       <td>#{sub.subscriptionId}</td>
       <td>#{sub.purchaseOrderNumber}</td>
       <td>#{sub.serviceName}</td>
       <td>
        <h:outputText value="#{sub.activationDate}">
         <f:convertDateTime pattern="#{msg[appBean.dateInputPattern]}"
                            timeZone="#{appBean.timeZoneId}"/>
        </h:outputText>
       </td>
       <td>
        <ui:include src="status.xhtml">
         <ui:param name="subscription" value="#{sub}"/>
        </ui:include>
       </td>
       <td>
        <div class="row">
         <div class="col-5" style="border-right: 3px solid grey; text-align: left;">
          <img
            src="/oscm-portal/image?type=SERVICE_IMAGE&amp;serviceKey=#{sub.serviceKey}"
            alt="editSubImage#{sub.subscriptionId}"/>
          <h2>#{sub.subscriptionId}</h2>
          <h3>
           <h:outputFormat value="#{msg['service.by']}">
            <f:param value="#{sub.supplierName}"/>
           </h:outputFormat>
          </h3>
         </div>
         <div class="col-sm-7">
          <div class="row">
           <div class="col-5" style="text-align: left;">
            <p>#{msg['subscription.activationDate']}</p>
            <p>#{msg['subscription.users']}</p>
            <p>#{msg['subscription.service']}</p>
            <p>#{msg['subscription.status']}</p>
           </div>
           <div class="col-7" style="text-align: left;">
            <h:outputText value="#{sub.activationDate}">
             <f:convertDateTime/>
            </h:outputText>
            <p class="mt-3">#{sub.numberOfAssignedUsers}</p>
            <p>#{sub.serviceName}</p>
            <ui:include src="status.xhtml">
             <ui:param name="sub" value="#{sub}"/>
            </ui:include>
           </div>
          </div>
         </div>
        </div>
        <div class="row">
         <div class="col-5" style="border-right: 3px solid grey;"></div>
         <div class="col-md-7" style="text-align: left;">
          <p>#{sub.serviceAccessInfo}</p>
         </div>
        </div>
       </td>
      </tr>
     </c:forEach>
     <c:forEach items="#{mySubscriptionsCtrl.myTriggerProcessesModel.waitingForApprovalSubs}" var="sub">
      <tr style="cursor: pointer;">
       <td><img
         src="/oscm-portal/image?type=SERVICE_IMAGE&amp;serviceKey=#{sub.serviceKey}"
         alt="editSubImage#{sub.subscriptionId}" width="30"/></td>
       <td>#{sub.serviceKey}</td>
       <td>
        <ui:include src="status.xhtml">
         <ui:param name="subscription" value="#{sub}"/>
        </ui:include>
       </td>
       <td>#{sub.purchaseOrderNumber}</td>
       <td>#{sub.serviceName}</td>
       <td>
        <h:outputText value="#{sub.activationDate}">
         <f:convertDateTime pattern="#{msg[appBean.dateInputPattern]}" timeZone="#{appBean.timeZoneId}"/>
        </h:outputText>
       </td>
      </tr>
     </c:forEach>
     </tbody>
    </table>

   </h:form>
  </a4j:outputPanel>
  <mp:linkPageTop/>

<style media="all" type="text/css">
 ul {
  width: 100% !important;
 }
 table.dataTable thead tr {
  background: rgba(0, 0, 0, 0.6);
  color: white;
 }
 table.dataTable tbody tr:hover{
  background: rgba(0, 0, 0, 0.5) !important;
  color: white;
 }
 table.dataTable tbody tr:nth-of-type(even){
  background: rgba(0, 0, 0, 0.2);
 }
 table.dataTable.dtr-inline.collapsed>tbody>tr>td.child {
  background: white;
  color: black;
 }
 a:visited {
 color: #F0FFFF !important;
 }
 table.dataTable.dtr-inline.collapsed>tbody>tr[role="row"]>td:first-child:before {
  background-color: darkslategray !important;
 }
}
</style>

<script type="text/javascript">
$(document).ready(function() {
 $('#table').DataTable({
  responsive: true,
  columnDefs: [{
   orderable: false,
   targets: 0
  }],
  renderer: $.fn.dataTable.Responsive.renderer.tableAll( {
   tableClass: 'table'
  })
 });
});
</script>

  <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css"/>
  <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css"/>
 </ui:define>
</ui:composition>